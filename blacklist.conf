# geo directive to deny certain ip addresses
geo $validate_client {
  default                        0;

  # Cyveillance
  38.100.19.8/29                 1;
  38.100.21.0/24                 1;
  38.100.41.64/26                1;
  38.105.71.0/25                 1;
  38.105.83.0/27                 1;
  38.112.21.140/30               1;
  38.118.42.32/29                1;
  65.213.208.128/27              1;
  65.222.176.96/27               1;
  65.222.185.72/29               1;
}

# map directive to check user-agent against bad bots, then
# checks client ip address to deny
map $http_user_agent $bad_client {
  default                        $validate_client;

  ~*(crawler|AltaVista|Slurp|BlackWidow|Bot|ChinaClaw|Custo|DISCo|Download|Demon|eCatch|EirGrabber|SuperHTTP|Express|WebPictures|Extractor|EyeNetIE|FlashGet|GetRight|GetWeb!|Go!Zilla|Go-Ahead-Got-It|GrabNet|Grafula|HMView|Go!Zilla|Go-Ahead-Got-It|rafula|HTTrack|Stripper|Sucker|Indy|InterGET|Ninja|JetCar|Spider|larbin|LeechFTP|tool|Navroad|NearSite|NetAnts|tAkeOut|WWWOFFLE|GrabNet|NetSpider|Vampire|NetZIP|Octopus|Offline|PageGrabber|Foto|pavuk|pcBrowser|ReGet|SiteSnagger|Teleport|VoidEYE|Collector|WebAuto|WebCopier|WebFetch|WebGo|WebLeacher|WebSauger|eXtractor|Quester|WebStripper|WebZIP|Wget|Widow|Zeus|Twengabot|htmlparser|libwww|Python|perl|urllib|scan|Curl|email|PycURL|Pyth|PyQ|WebCollector|WebCopy|webcraw|Aboundex|80legs|360Spider|Bandit|Buddy|Copier|Reaper|Recorder|Siphon|Whacker|ZmEu|Acunetix) 1;
  "~*^Java"                      1;
  "~*^asterias"                  1;
  "~*^attach"                    1;
  "~*^BackWeb"                   1;
  "~*^BatchFTP"                  1;
  "~*^Bigfoot"                   1;
  "~*^Black.Hole"                1;
  "~*^BlowFish"                  1;
  "~*^Bullseye"                  1;
  "~*^BunnySlippers"             1;
  "~*^Cegbfeieh"                 1;
  "~*^CherryPicker"              1;
  "~*^CopyRightCheck"            1;
  "~*^cosmos"                    1;
  "~*^Crescent"                  1;
  "~*^DittoSpyder"               1;
  "~*^dragonfly"                 1;
  "~*^Drip"                      1;
  "~*^EasyDL"                    1;
  "~*^ebingbong"                 1;
  "~*^flunky"                    1;
  "~*^FrontPage"                 1;
  "~*^gotit"                     1;
  "~*^Harvest"                   1;
  "~*^hloader"                   1;
  "~*^humanlinks"                1;
  "~*^Image\ Stripper"           1;
  "~*^Image\ Sucker"             1;
  "~*^InfoTekies"                1;
  "~*^Intelliseek"               1;
  "~*^Iria"                      1;
  "~*^Jakarta"                   1;
  "~*^JOC"                       1;
  "~*^JustView"                  1;
  "~*^Keyword.Density"           1;
  "~*^lftp"                      1;
  "~*^libWeb/clsHTTP"            1;
  "~*^likse"                     1;
  "~*^LinkScan/8.1a.Unix"        1;
  "~*^LinkWalker"                1;
  "~*^lwp-trivial"               1;
  "~*^LWP::Simple"               1;
  "~*^Magnet"                    1;
  "~*^Mag-Net"                   1;
  "~*^MarkWatch"                 1;
  "~*^Mata.Hari"                 1;
  "~*^Memo"                      1;
  "~*^Microsoft.URL"             1;
  "~*^Microsoft\ URL\ Control"   1;
  "~*^MIIxpc"                    1;
  "~*^Mirror"                    1;
  "~*^Missigua\ Locator"         1;
  "~*^Mister\ PiX"               1;
  "~*^moget"                     1;
  "~*^Mozilla/3.Mozilla/2.01"    1;
  "~*^Mozilla.*NEWT"             1;
  "~*^NAMEPROTECT"               1;
  "~*^Netcraft"                  1;
  "~*^NetMechanic"               1;
  "~*^NG"                        1;
  "~*^NICErsPRO"                 1;
  "~*^Openfind"                  1;
  "~*^Papa\ Foto"                1;
  "~*^PHP\ version\ tracker"     1;
  "~*^Pockey"                    1;
  "~*^ProWebWalker"              1;
  "~*^Pump"                      1;
  "~*^QueryN.Metasearch"         1;
  "~*^RepoMonkey"                1;
  "~*^RMA"                       1;
  "~*^SlySearch"                 1;
  "~*^Snake"                     1;
  "~*^Snoopy"                    1;
  "~*^sogou"                     1;
  "~*^SpaceBison"                1;
  "~*^spanner"                   1;
  "~*^Sqworm"                    1;
  "~*^suzuran"                   1;
  "~*^Szukacz/1.4"               1;
  "~*^Telesoft"                  1;
  "~*^The.Intraformant"          1;
  "~*^TheNomad"                  1;
  "~*^Titan"                     1;
  "~*^turingos"                  1;
  "~*^URLy.Warning"              1;
  "~*^Vacuum"                    1;
  "~*^VCI"                       1;
  "~*^Web\ Sucker"               1;
  "~*^Webclipping.com"           1;
  "~*^WebEnhancer"               1;
  "~*^Website\ Quester"          1;
  "~*^Webster"                   1;
  "~*^WebStripper"               1;
  "~*^WWW-Collector-E"           1;
  "~*^Xaldon"                    1;
  "~*^Xenu"                      1;
  "~*^Zyborg"                    1;
}
